var $a8e0976cbde3892e4f106867fc0ee70a$exports = {};
var $a8e0976cbde3892e4f106867fc0ee70a$var$trim = $parcel$require("a8e0976cbde3892e4f106867fc0ee70a", "trim-trailing-lines");
$a8e0976cbde3892e4f106867fc0ee70a$exports = $a8e0976cbde3892e4f106867fc0ee70a$var$fencedCode;
var $a8e0976cbde3892e4f106867fc0ee70a$var$C_NEWLINE = '\n';
var $a8e0976cbde3892e4f106867fc0ee70a$var$C_TAB = '\t';
var $a8e0976cbde3892e4f106867fc0ee70a$var$C_SPACE = ' ';
var $a8e0976cbde3892e4f106867fc0ee70a$var$C_TILDE = '~';
var $a8e0976cbde3892e4f106867fc0ee70a$var$C_TICK = '`';
var $a8e0976cbde3892e4f106867fc0ee70a$var$MIN_FENCE_COUNT = 3;
var $a8e0976cbde3892e4f106867fc0ee70a$var$CODE_INDENT_COUNT = 4;

function $a8e0976cbde3892e4f106867fc0ee70a$var$fencedCode(eat, value, silent) {
  var self = this;
  var settings = self.options;
  var length = value.length + 1;
  var index = 0;
  var subvalue = '';
  var fenceCount;
  var marker;
  var character;
  var flag;
  var queue;
  var content;
  var exdentedContent;
  var closing;
  var exdentedClosing;
  var indent;
  var now;

  if (!settings.gfm) {
    return;
  }
  /* Eat initial spacing. */


  while (index < length) {
    character = value.charAt(index);

    if (character !== $a8e0976cbde3892e4f106867fc0ee70a$var$C_SPACE && character !== $a8e0976cbde3892e4f106867fc0ee70a$var$C_TAB) {
      break;
    }

    subvalue += character;
    index++;
  }

  indent = index;
  /* Eat the fence. */

  character = value.charAt(index);

  if (character !== $a8e0976cbde3892e4f106867fc0ee70a$var$C_TILDE && character !== $a8e0976cbde3892e4f106867fc0ee70a$var$C_TICK) {
    return;
  }

  index++;
  marker = character;
  fenceCount = 1;
  subvalue += character;

  while (index < length) {
    character = value.charAt(index);

    if (character !== marker) {
      break;
    }

    subvalue += character;
    fenceCount++;
    index++;
  }

  if (fenceCount < $a8e0976cbde3892e4f106867fc0ee70a$var$MIN_FENCE_COUNT) {
    return;
  }
  /* Eat spacing before flag. */


  while (index < length) {
    character = value.charAt(index);

    if (character !== $a8e0976cbde3892e4f106867fc0ee70a$var$C_SPACE && character !== $a8e0976cbde3892e4f106867fc0ee70a$var$C_TAB) {
      break;
    }

    subvalue += character;
    index++;
  }
  /* Eat flag. */


  flag = '';
  queue = '';

  while (index < length) {
    character = value.charAt(index);

    if (character === $a8e0976cbde3892e4f106867fc0ee70a$var$C_NEWLINE || character === $a8e0976cbde3892e4f106867fc0ee70a$var$C_TILDE || character === $a8e0976cbde3892e4f106867fc0ee70a$var$C_TICK) {
      break;
    }

    if (character === $a8e0976cbde3892e4f106867fc0ee70a$var$C_SPACE || character === $a8e0976cbde3892e4f106867fc0ee70a$var$C_TAB) {
      queue += character;
    } else {
      flag += queue + character;
      queue = '';
    }

    index++;
  }

  character = value.charAt(index);

  if (character && character !== $a8e0976cbde3892e4f106867fc0ee70a$var$C_NEWLINE) {
    return;
  }

  if (silent) {
    return true;
  }

  now = eat.now();
  now.column += subvalue.length;
  now.offset += subvalue.length;
  subvalue += flag;
  flag = self.decode.raw(self.unescape(flag), now);

  if (queue) {
    subvalue += queue;
  }

  queue = '';
  closing = '';
  exdentedClosing = '';
  content = '';
  exdentedContent = '';
  /* Eat content. */

  while (index < length) {
    character = value.charAt(index);
    content += closing;
    exdentedContent += exdentedClosing;
    closing = '';
    exdentedClosing = '';

    if (character !== $a8e0976cbde3892e4f106867fc0ee70a$var$C_NEWLINE) {
      content += character;
      exdentedClosing += character;
      index++;
      continue;
    }
    /* Add the newline to `subvalue` if its the first
     * character.  Otherwise, add it to the `closing`
     * queue. */


    if (content) {
      closing += character;
      exdentedClosing += character;
    } else {
      subvalue += character;
    }

    queue = '';
    index++;

    while (index < length) {
      character = value.charAt(index);

      if (character !== $a8e0976cbde3892e4f106867fc0ee70a$var$C_SPACE) {
        break;
      }

      queue += character;
      index++;
    }

    closing += queue;
    exdentedClosing += queue.slice(indent);

    if (queue.length >= $a8e0976cbde3892e4f106867fc0ee70a$var$CODE_INDENT_COUNT) {
      continue;
    }

    queue = '';

    while (index < length) {
      character = value.charAt(index);

      if (character !== marker) {
        break;
      }

      queue += character;
      index++;
    }

    closing += queue;
    exdentedClosing += queue;

    if (queue.length < fenceCount) {
      continue;
    }

    queue = '';

    while (index < length) {
      character = value.charAt(index);

      if (character !== $a8e0976cbde3892e4f106867fc0ee70a$var$C_SPACE && character !== $a8e0976cbde3892e4f106867fc0ee70a$var$C_TAB) {
        break;
      }

      closing += character;
      exdentedClosing += character;
      index++;
    }

    if (!character || character === $a8e0976cbde3892e4f106867fc0ee70a$var$C_NEWLINE) {
      break;
    }
  }

  subvalue += content + closing;
  return eat(subvalue)({
    type: 'code',
    lang: flag || null,
    value: $a8e0976cbde3892e4f106867fc0ee70a$var$trim(exdentedContent)
  });
}