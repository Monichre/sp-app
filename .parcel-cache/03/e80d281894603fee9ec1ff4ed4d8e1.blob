var $d531375fa731c636654b998026571734$exports = {};
$parcel$require("d531375fa731c636654b998026571734", "react");
$parcel$require("d531375fa731c636654b998026571734", "styled-components");
$parcel$require("d531375fa731c636654b998026571734", "react-router");
$parcel$require("d531375fa731c636654b998026571734", "../../../shared/Loading");
$parcel$require("d531375fa731c636654b998026571734", "../../../types");
$parcel$require("d531375fa731c636654b998026571734", "../ErrorBoundary");
$parcel$require("d531375fa731c636654b998026571734", "./Insights/Insights");
$parcel$require("d531375fa731c636654b998026571734", "../../../shared/media");
$parcel$require("d531375fa731c636654b998026571734", "./NavMenu");
$parcel$require("d531375fa731c636654b998026571734", "./Profile/Profile");
$parcel$require("d531375fa731c636654b998026571734", "./History/History");
$parcel$require("d531375fa731c636654b998026571734", "../../../lib/intercom");
$parcel$require("d531375fa731c636654b998026571734", "../../Components/SideBar/SideBar");

function $d531375fa731c636654b998026571734$var$_extends() { $d531375fa731c636654b998026571734$var$_extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return $d531375fa731c636654b998026571734$var$_extends.apply(this, arguments); }

function $d531375fa731c636654b998026571734$var$_objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = $d531375fa731c636654b998026571734$var$_objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }

function $d531375fa731c636654b998026571734$var$_objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }

function $d531375fa731c636654b998026571734$var$_toConsumableArray(arr) { return $d531375fa731c636654b998026571734$var$_arrayWithoutHoles(arr) || $d531375fa731c636654b998026571734$var$_iterableToArray(arr) || $d531375fa731c636654b998026571734$var$_nonIterableSpread(); }

function $d531375fa731c636654b998026571734$var$_nonIterableSpread() { throw new TypeError("Invalid attempt to spread non-iterable instance"); }

function $d531375fa731c636654b998026571734$var$_iterableToArray(iter) { if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === "[object Arguments]") return Array.from(iter); }

function $d531375fa731c636654b998026571734$var$_arrayWithoutHoles(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } }

function $d531375fa731c636654b998026571734$var$_slicedToArray(arr, i) { return $d531375fa731c636654b998026571734$var$_arrayWithHoles(arr) || $d531375fa731c636654b998026571734$var$_iterableToArrayLimit(arr, i) || $d531375fa731c636654b998026571734$var$_nonIterableRest(); }

function $d531375fa731c636654b998026571734$var$_nonIterableRest() { throw new TypeError("Invalid attempt to destructure non-iterable instance"); }

function $d531375fa731c636654b998026571734$var$_iterableToArrayLimit(arr, i) { if (!(Symbol.iterator in Object(arr) || Object.prototype.toString.call(arr) === "[object Arguments]")) { return; } var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i["return"] != null) _i["return"](); } finally { if (_d) throw _e; } } return _arr; }

function $d531375fa731c636654b998026571734$var$_arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }

function $d531375fa731c636654b998026571734$var$ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function $d531375fa731c636654b998026571734$var$_objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { $d531375fa731c636654b998026571734$var$ownKeys(Object(source), true).forEach(function (key) { $d531375fa731c636654b998026571734$var$_defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { $d531375fa731c636654b998026571734$var$ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function $d531375fa731c636654b998026571734$var$_defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

function $d531375fa731c636654b998026571734$var$_templateObject4() {
  var data = $d531375fa731c636654b998026571734$var$_taggedTemplateLiteral(["\n      display: flex;\n      flex-direction: row;\n      justify-content: center;\n      background-color: #030616;\n      position: fixed;\n      height: 15vh;\n      left: 0;\n      right: 0;\n      width: 100%;\n      bottom: 0;\n\n      @media screen and (max-width: 600px) {\n        height: 10vh;\n\n        svg {\n          margin-bottom: 0;\n          height: 20px;\n          width: 20px;\n        }\n      }\n      .sc-iELTvK {\n       padding: 0;\n       justify-content: center;\n       display: flex;\n       align-content: center;\n\n       align-items: center;\n\n      }\n      .sc-feJyhm.escZRd {\n        display: none;\n      } \n      .sc-hzDkRC.ldGACO {\n        margin: auto;\n        display: block;\n        position: relative;\n      }\n    "]);

  $d531375fa731c636654b998026571734$var$_templateObject4 = function _templateObject4() {
    return data;
  };

  return data;
}

function $d531375fa731c636654b998026571734$var$_templateObject3() {
  var data = $d531375fa731c636654b998026571734$var$_taggedTemplateLiteral(["\n      flex-direction: column;\n      left: 0;\n      height: 100vh;\n      top: 0;\n      width: ", "px;\n      border-right: 1px solid rgba(255, 255, 255, .1);\n    "]);

  $d531375fa731c636654b998026571734$var$_templateObject3 = function _templateObject3() {
    return data;
  };

  return data;
}

function $d531375fa731c636654b998026571734$var$_templateObject2() {
  var data = $d531375fa731c636654b998026571734$var$_taggedTemplateLiteral(["\n    padding-left: ", "px;\n  "]);

  $d531375fa731c636654b998026571734$var$_templateObject2 = function _templateObject2() {
    return data;
  };

  return data;
}

function $d531375fa731c636654b998026571734$var$_templateObject() {
  var data = $d531375fa731c636654b998026571734$var$_taggedTemplateLiteral(["\n  height: 100%;\n  width: 100%;\n  background-color: #030616;\n  position: relative;\n\n  ", "\n  ", " {\n    position: fixed;\n    \n    display: flex;\n    ", "\n    \n    ", "\n  }\n"]);

  $d531375fa731c636654b998026571734$var$_templateObject = function _templateObject() {
    return data;
  };

  return data;
}

function $d531375fa731c636654b998026571734$var$_taggedTemplateLiteral(strings, raw) { if (!raw) { raw = strings.slice(0); } return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }

var $d531375fa731c636654b998026571734$var$DescriptionItem = function DescriptionItem(_ref) {
  var title = _ref.title,
      content = _ref.content;
  return $d531375fa731c636654b998026571734$import$React.createElement("div", {
    style: {
      fontSize: 14,
      lineHeight: '22px',
      marginBottom: 7,
      color: 'rgba(0,0,0,0.65)'
    }
  }, $d531375fa731c636654b998026571734$import$React.createElement("p", {
    style: {
      marginRight: 8,
      display: 'inline-block',
      color: 'rgba(0,0,0,0.85)'
    }
  }, title, ":"), content);
};

var $d531375fa731c636654b998026571734$var$SIDEBAR_WIDTH = 200;
var $d531375fa731c636654b998026571734$var$AuthedView = $d531375fa731c636654b998026571734$import$styled.div($d531375fa731c636654b998026571734$var$_templateObject(), $d531375fa731c636654b998026571734$import$largeQuery($d531375fa731c636654b998026571734$var$_templateObject2(), $d531375fa731c636654b998026571734$var$SIDEBAR_WIDTH), $d531375fa731c636654b998026571734$import$NavMenuView, $d531375fa731c636654b998026571734$import$largeQuery($d531375fa731c636654b998026571734$var$_templateObject3(), $d531375fa731c636654b998026571734$var$SIDEBAR_WIDTH), $d531375fa731c636654b998026571734$import$notLargeQuery($d531375fa731c636654b998026571734$var$_templateObject4()));

/**
 *
 * cc:signin#2;User is Authenticated
 *
 */
var $d531375fa731c636654b998026571734$var$initialState = {
  currentUser: {},
  achievements: {
    week: null,
    month: null,
    life: null
  },
  topArtistsWithAchievementHolders: [],
  notifications: [],
  isOpen: false
};
var $d531375fa731c636654b998026571734$export$UserAchievementContext = $d531375fa731c636654b998026571734$import$createContext($d531375fa731c636654b998026571734$var$_objectSpread({}, $d531375fa731c636654b998026571734$var$initialState.currentUser, {}, $d531375fa731c636654b998026571734$var$initialState.achievements, {
  setAchievements: function setAchievements() {
    return $d531375fa731c636654b998026571734$var$initialState.achievements;
  }
}, $d531375fa731c636654b998026571734$var$initialState.achievements.isOpen, {
  setSideBarOpen: function setSideBarOpen() {
    return $d531375fa731c636654b998026571734$var$initialState.achievements.isOpen;
  }
}, $d531375fa731c636654b998026571734$var$initialState.topArtistsWithAchievementHolders, {
  setTopArtistsWithAchievementHolders: function setTopArtistsWithAchievementHolders() {
    return $d531375fa731c636654b998026571734$var$initialState.topArtistsWithAchievementHolders;
  }
}, $d531375fa731c636654b998026571734$var$initialState.notifications, {
  setNotifications: function setNotifications() {
    return [];
  }
}));
$d531375fa731c636654b998026571734$exports.UserAchievementContext = $d531375fa731c636654b998026571734$export$UserAchievementContext;

var $d531375fa731c636654b998026571734$var$UserAchievementDataProvider = function UserAchievementDataProvider(_ref2) {
  var user = _ref2.user,
      children = _ref2.children,
      isOpen = _ref2.isOpen,
      setSideBarOpen = _ref2.setSideBarOpen;

  var _useState = $d531375fa731c636654b998026571734$import$useState($d531375fa731c636654b998026571734$var$initialState.achievements),
      _useState2 = $d531375fa731c636654b998026571734$var$_slicedToArray(_useState, 2),
      achievements = _useState2[0],
      setAppAchievements = _useState2[1];

  var _useState3 = $d531375fa731c636654b998026571734$import$useState($d531375fa731c636654b998026571734$var$initialState.topArtistsWithAchievementHolders),
      _useState4 = $d531375fa731c636654b998026571734$var$_slicedToArray(_useState3, 2),
      topArtistsWithAchievementHolders = _useState4[0],
      setAppComponentWithArtistsWithAchievementHolders = _useState4[1];

  var _useState5 = $d531375fa731c636654b998026571734$import$useState(user),
      _useState6 = $d531375fa731c636654b998026571734$var$_slicedToArray(_useState5, 2),
      currentUser = _useState6[0],
      setCurrentUser = _useState6[1];

  var _useState7 = $d531375fa731c636654b998026571734$import$useState(null),
      _useState8 = $d531375fa731c636654b998026571734$var$_slicedToArray(_useState7, 2),
      appNotifications = _useState8[0],
      setAppNotifications = _useState8[1];

  var setNotifications = function setNotifications(newNotifications) {
    setAppNotifications(function (appNotifications) {
      return newNotifications;
    });
  };

  var setAchievements = function setAchievements(newAchievements) {
    localStorage.setItem('userAchievements', JSON.stringify(newAchievements));
    setAppAchievements(newAchievements);
  };

  var setTopArtistsWithAchievementHolders = function setTopArtistsWithAchievementHolders(newArtistsWithAchievements) {
    return setAppComponentWithArtistsWithAchievementHolders(function (topArtistsWithAchievementHolders) {
      return topArtistsWithAchievementHolders && topArtistsWithAchievementHolders.length && newArtistsWithAchievements && newArtistsWithAchievements.length ? [].concat($d531375fa731c636654b998026571734$var$_toConsumableArray(topArtistsWithAchievementHolders), $d531375fa731c636654b998026571734$var$_toConsumableArray(newArtistsWithAchievements)) : newArtistsWithAchievements && newArtistsWithAchievements.length ? $d531375fa731c636654b998026571734$var$_toConsumableArray(newArtistsWithAchievements) : [];
    });
  };

  return $d531375fa731c636654b998026571734$import$React.createElement($d531375fa731c636654b998026571734$export$UserAchievementContext.Provider, {
    value: {
      achievements: achievements,
      setAchievements: setAchievements,
      currentUser: currentUser,
      setSideBarOpen: setSideBarOpen,
      isOpen: isOpen,
      setTopArtistsWithAchievementHolders: setTopArtistsWithAchievementHolders,
      topArtistsWithAchievementHolders: topArtistsWithAchievementHolders,
      appNotifications: appNotifications,
      setNotifications: setNotifications
    }
  }, children);
};

var $d531375fa731c636654b998026571734$export$Authed = function Authed(_ref3) {
  var firebaseUser = _ref3.user,
      rest = $d531375fa731c636654b998026571734$var$_objectWithoutProperties(_ref3, ["user"]);
  var result = $d531375fa731c636654b998026571734$import$useGetUserInfo({
    variables: {
      uid: firebaseUser.uid
    },
    pollInterval: 4000,
    suspend: true
  });
  var user = result.data && result.data.getUserInfo;

  if (!user) {
    return $d531375fa731c636654b998026571734$import$React.createElement($d531375fa731c636654b998026571734$import$ErrorFallback, null);
  }

  var initialHarvestComplete = user.initialHarvestComplete,
      lastUpdate = user.lastUpdate,
      uid = user.uid; //@ts-ignore

  var intercomUser = JSON.parse(localStorage.getItem('intercomUser'));

  if ("production" === 'production') {
    $d531375fa731c636654b998026571734$import$IntercomHandler.boot(user, 'boot');
  }

  if (!intercomUser && intercomUser !== user.displayName) {
    if ("production" === 'production') {
      $d531375fa731c636654b998026571734$import$IntercomHandler.trackEvent(user, 'user-login');
      localStorage.setItem('intercomUser', JSON.stringify(user.displayName));
    }
  }

  var _useState9 = $d531375fa731c636654b998026571734$import$useState(false),
      _useState10 = $d531375fa731c636654b998026571734$var$_slicedToArray(_useState9, 2),
      isOpen = _useState10[0],
      openSideBar = _useState10[1];

  var setSideBarOpen = function setSideBarOpen() {
    return openSideBar(function (isOpen) {
      return !isOpen;
    });
  };

  return $d531375fa731c636654b998026571734$import$React.createElement($d531375fa731c636654b998026571734$import$React.Fragment, null, $d531375fa731c636654b998026571734$import$React.createElement($d531375fa731c636654b998026571734$var$AuthedView, null, $d531375fa731c636654b998026571734$import$React.createElement($d531375fa731c636654b998026571734$var$UserAchievementDataProvider, {
    setSideBarOpen: setSideBarOpen,
    user: user,
    isOpen: isOpen
  }, $d531375fa731c636654b998026571734$import$React.createElement($d531375fa731c636654b998026571734$import$NavMenu, $d531375fa731c636654b998026571734$var$_objectSpread({
    initialHarvestComplete: initialHarvestComplete || false,
    lastUpdate: lastUpdate || '',
    user: user
  }, rest)), $d531375fa731c636654b998026571734$import$React.createElement($d531375fa731c636654b998026571734$import$SideBar, null), $d531375fa731c636654b998026571734$import$React.createElement($d531375fa731c636654b998026571734$import$React.Suspense, {
    fallback: $d531375fa731c636654b998026571734$import$React.createElement($d531375fa731c636654b998026571734$import$Loading, null)
  }, $d531375fa731c636654b998026571734$import$React.createElement($d531375fa731c636654b998026571734$import$Switch, null, $d531375fa731c636654b998026571734$import$React.createElement($d531375fa731c636654b998026571734$import$Route, {
    path: "/insights/:timeScope/:groupId/:perspective",
    render: function render(props) {
      return $d531375fa731c636654b998026571734$import$React.createElement($d531375fa731c636654b998026571734$import$Insights, $d531375fa731c636654b998026571734$var$_extends({
        user: user
      }, props, {
        uid: uid
      }));
    }
  }), $d531375fa731c636654b998026571734$import$React.createElement($d531375fa731c636654b998026571734$import$Route, {
    path: "/history",
    render: function render(props) {
      return $d531375fa731c636654b998026571734$import$React.createElement($d531375fa731c636654b998026571734$import$History, $d531375fa731c636654b998026571734$var$_extends({
        user: user
      }, props, {
        uid: uid
      }));
    }
  }), $d531375fa731c636654b998026571734$import$React.createElement($d531375fa731c636654b998026571734$import$Route, {
    path: "/profile",
    render: function render(props) {
      return $d531375fa731c636654b998026571734$import$React.createElement($d531375fa731c636654b998026571734$import$Profile, $d531375fa731c636654b998026571734$var$_extends({
        user: user
      }, props));
    }
  }), $d531375fa731c636654b998026571734$import$React.createElement($d531375fa731c636654b998026571734$import$Redirect, {
    from: "/",
    to: "/insights/thisWeek/global/personal"
  }))))));
};

$d531375fa731c636654b998026571734$exports.Authed = $d531375fa731c636654b998026571734$export$Authed;