var $ff961ade9f9b5e86fd96f5b861$exports = {};
$parcel$require("434107ff961ade9f9b5e86fd96f5b861", "tslib");
$parcel$require("434107ff961ade9f9b5e86fd96f5b861", "apollo-cache");
$parcel$require("434107ff961ade9f9b5e86fd96f5b861", "apollo-utilities");
$parcel$require("434107ff961ade9f9b5e86fd96f5b861", "optimism");
$parcel$require("434107ff961ade9f9b5e86fd96f5b861", "ts-invariant");
var $ff961ade9f9b5e86fd96f5b861$var$haveWarned = false;

function $ff961ade9f9b5e86fd96f5b861$var$shouldWarn() {
  var answer = !$ff961ade9f9b5e86fd96f5b861$var$haveWarned;

  if (!$ff961ade9f9b5e86fd96f5b861$import$isTest()) {
    $ff961ade9f9b5e86fd96f5b861$var$haveWarned = true;
  }

  return answer;
}

var $ff961ade9f9b5e86fd96f5b861$export$HeuristicFragmentMatcher = function () {
  function HeuristicFragmentMatcher() {}

  HeuristicFragmentMatcher.prototype.ensureReady = function () {
    return Promise.resolve();
  };

  HeuristicFragmentMatcher.prototype.canBypassInit = function () {
    return true;
  };

  HeuristicFragmentMatcher.prototype.match = function (idValue, typeCondition, context) {
    var obj = context.store.get(idValue.id);
    var isRootQuery = idValue.id === 'ROOT_QUERY';

    if (!obj) {
      return isRootQuery;
    }

    var _a = obj.__typename,
        __typename = _a === void 0 ? isRootQuery && 'Query' : _a;

    if (!__typename) {
      if ($ff961ade9f9b5e86fd96f5b861$var$shouldWarn()) {
        "production" === "production" || $ff961ade9f9b5e86fd96f5b861$import$invariant.warn("You're using fragments in your queries, but either don't have the addTypename:\n  true option set in Apollo Client, or you are trying to write a fragment to the store without the __typename.\n   Please turn on the addTypename option and include __typename when writing fragments so that Apollo Client\n   can accurately match fragments.");
        "production" === "production" || $ff961ade9f9b5e86fd96f5b861$import$invariant.warn('Could not find __typename on Fragment ', typeCondition, obj);
        "production" === "production" || $ff961ade9f9b5e86fd96f5b861$import$invariant.warn("DEPRECATION WARNING: using fragments without __typename is unsupported behavior " + "and will be removed in future versions of Apollo client. You should fix this and set addTypename to true now.");
      }

      return 'heuristic';
    }

    if (__typename === typeCondition) {
      return true;
    }

    if ($ff961ade9f9b5e86fd96f5b861$var$shouldWarn()) {
      "production" === "production" || $ff961ade9f9b5e86fd96f5b861$import$invariant.error('You are using the simple (heuristic) fragment matcher, but your ' + 'queries contain union or interface types. Apollo Client will not be ' + 'able to accurately map fragments. To make this error go away, use ' + 'the `IntrospectionFragmentMatcher` as described in the docs: ' + 'https://www.apollographql.com/docs/react/advanced/fragments.html#fragment-matcher');
    }

    return 'heuristic';
  };

  return HeuristicFragmentMatcher;
}();

var $ff961ade9f9b5e86fd96f5b861$export$IntrospectionFragmentMatcher = function () {
  function IntrospectionFragmentMatcher(options) {
    if (options && options.introspectionQueryResultData) {
      this.possibleTypesMap = this.parseIntrospectionResult(options.introspectionQueryResultData);
      this.isReady = true;
    } else {
      this.isReady = false;
    }

    this.match = this.match.bind(this);
  }

  IntrospectionFragmentMatcher.prototype.match = function (idValue, typeCondition, context) {
    "production" === "production" ? $ff961ade9f9b5e86fd96f5b861$import$invariant(this.isReady, 2) : $ff961ade9f9b5e86fd96f5b861$import$invariant(this.isReady, 'FragmentMatcher.match() was called before FragmentMatcher.init()');
    var obj = context.store.get(idValue.id);
    var isRootQuery = idValue.id === 'ROOT_QUERY';

    if (!obj) {
      return isRootQuery;
    }

    var _a = obj.__typename,
        __typename = _a === void 0 ? isRootQuery && 'Query' : _a;

    "production" === "production" ? $ff961ade9f9b5e86fd96f5b861$import$invariant(__typename, 3) : $ff961ade9f9b5e86fd96f5b861$import$invariant(__typename, "Cannot match fragment because __typename property is missing: " + JSON.stringify(obj));

    if (__typename === typeCondition) {
      return true;
    }

    var implementingTypes = this.possibleTypesMap[typeCondition];

    if (__typename && implementingTypes && implementingTypes.indexOf(__typename) > -1) {
      return true;
    }

    return false;
  };

  IntrospectionFragmentMatcher.prototype.parseIntrospectionResult = function (introspectionResultData) {
    var typeMap = {};

    introspectionResultData.__schema.types.forEach(function (type) {
      if (type.kind === 'UNION' || type.kind === 'INTERFACE') {
        typeMap[type.name] = type.possibleTypes.map(function (implementingType) {
          return implementingType.name;
        });
      }
    });

    return typeMap;
  };

  return IntrospectionFragmentMatcher;
}();

var $ff961ade9f9b5e86fd96f5b861$var$hasOwn = Object.prototype.hasOwnProperty;

var $ff961ade9f9b5e86fd96f5b861$var$DepTrackingCache = function () {
  function DepTrackingCache(data) {
    var _this = this;

    if (data === void 0) {
      data = Object.create(null);
    }

    this.data = data;
    this.depend = $ff961ade9f9b5e86fd96f5b861$import$wrap(function (dataId) {
      return _this.data[dataId];
    }, {
      disposable: true,
      makeCacheKey: function (dataId) {
        return dataId;
      }
    });
  }

  DepTrackingCache.prototype.toObject = function () {
    return this.data;
  };

  DepTrackingCache.prototype.get = function (dataId) {
    this.depend(dataId);
    return this.data[dataId];
  };

  DepTrackingCache.prototype.set = function (dataId, value) {
    var oldValue = this.data[dataId];

    if (value !== oldValue) {
      this.data[dataId] = value;
      this.depend.dirty(dataId);
    }
  };

  DepTrackingCache.prototype.delete = function (dataId) {
    if ($ff961ade9f9b5e86fd96f5b861$var$hasOwn.call(this.data, dataId)) {
      delete this.data[dataId];
      this.depend.dirty(dataId);
    }
  };

  DepTrackingCache.prototype.clear = function () {
    this.replace(null);
  };

  DepTrackingCache.prototype.replace = function (newData) {
    var _this = this;

    if (newData) {
      Object.keys(newData).forEach(function (dataId) {
        _this.set(dataId, newData[dataId]);
      });
      Object.keys(this.data).forEach(function (dataId) {
        if (!$ff961ade9f9b5e86fd96f5b861$var$hasOwn.call(newData, dataId)) {
          _this.delete(dataId);
        }
      });
    } else {
      Object.keys(this.data).forEach(function (dataId) {
        _this.delete(dataId);
      });
    }
  };

  return DepTrackingCache;
}();

function $ff961ade9f9b5e86fd96f5b861$var$defaultNormalizedCacheFactory(seed) {
  return new $ff961ade9f9b5e86fd96f5b861$var$DepTrackingCache(seed);
}

var $ff961ade9f9b5e86fd96f5b861$export$StoreReader = function () {
  function StoreReader(_a) {
    var _this = this;

    var _b = _a === void 0 ? {} : _a,
        _c = _b.cacheKeyRoot,
        cacheKeyRoot = _c === void 0 ? new $ff961ade9f9b5e86fd96f5b861$import$KeyTrie($ff961ade9f9b5e86fd96f5b861$import$canUseWeakMap) : _c,
        _d = _b.freezeResults,
        freezeResults = _d === void 0 ? false : _d;

    var _e = this,
        executeStoreQuery = _e.executeStoreQuery,
        executeSelectionSet = _e.executeSelectionSet,
        executeSubSelectedArray = _e.executeSubSelectedArray;

    this.freezeResults = freezeResults;
    this.executeStoreQuery = $ff961ade9f9b5e86fd96f5b861$import$wrap(function (options) {
      return executeStoreQuery.call(_this, options);
    }, {
      makeCacheKey: function (_a) {
        var query = _a.query,
            rootValue = _a.rootValue,
            contextValue = _a.contextValue,
            variableValues = _a.variableValues,
            fragmentMatcher = _a.fragmentMatcher;

        if (contextValue.store instanceof $ff961ade9f9b5e86fd96f5b861$var$DepTrackingCache) {
          return cacheKeyRoot.lookup(contextValue.store, query, fragmentMatcher, JSON.stringify(variableValues), rootValue.id);
        }
      }
    });
    this.executeSelectionSet = $ff961ade9f9b5e86fd96f5b861$import$wrap(function (options) {
      return executeSelectionSet.call(_this, options);
    }, {
      makeCacheKey: function (_a) {
        var selectionSet = _a.selectionSet,
            rootValue = _a.rootValue,
            execContext = _a.execContext;

        if (execContext.contextValue.store instanceof $ff961ade9f9b5e86fd96f5b861$var$DepTrackingCache) {
          return cacheKeyRoot.lookup(execContext.contextValue.store, selectionSet, execContext.fragmentMatcher, JSON.stringify(execContext.variableValues), rootValue.id);
        }
      }
    });
    this.executeSubSelectedArray = $ff961ade9f9b5e86fd96f5b861$import$wrap(function (options) {
      return executeSubSelectedArray.call(_this, options);
    }, {
      makeCacheKey: function (_a) {
        var field = _a.field,
            array = _a.array,
            execContext = _a.execContext;

        if (execContext.contextValue.store instanceof $ff961ade9f9b5e86fd96f5b861$var$DepTrackingCache) {
          return cacheKeyRoot.lookup(execContext.contextValue.store, field, array, JSON.stringify(execContext.variableValues));
        }
      }
    });
  }

  StoreReader.prototype.readQueryFromStore = function (options) {
    return this.diffQueryAgainstStore($ff961ade9f9b5e86fd96f5b861$import$__assign($ff961ade9f9b5e86fd96f5b861$import$__assign({}, options), {
      returnPartialData: false
    })).result;
  };

  StoreReader.prototype.diffQueryAgainstStore = function (_a) {
    var store = _a.store,
        query = _a.query,
        variables = _a.variables,
        previousResult = _a.previousResult,
        _b = _a.returnPartialData,
        returnPartialData = _b === void 0 ? true : _b,
        _c = _a.rootId,
        rootId = _c === void 0 ? 'ROOT_QUERY' : _c,
        fragmentMatcherFunction = _a.fragmentMatcherFunction,
        config = _a.config;
    var queryDefinition = $ff961ade9f9b5e86fd96f5b861$import$getQueryDefinition(query);
    variables = $ff961ade9f9b5e86fd96f5b861$import$assign({}, $ff961ade9f9b5e86fd96f5b861$import$getDefaultValues(queryDefinition), variables);
    var context = {
      store: store,
      dataIdFromObject: config && config.dataIdFromObject,
      cacheRedirects: config && config.cacheRedirects || {}
    };
    var execResult = this.executeStoreQuery({
      query: query,
      rootValue: {
        type: 'id',
        id: rootId,
        generated: true,
        typename: 'Query'
      },
      contextValue: context,
      variableValues: variables,
      fragmentMatcher: fragmentMatcherFunction
    });
    var hasMissingFields = execResult.missing && execResult.missing.length > 0;

    if (hasMissingFields && !returnPartialData) {
      execResult.missing.forEach(function (info) {
        if (info.tolerable) return;
        throw "production" === "production" ? new $ff961ade9f9b5e86fd96f5b861$import$InvariantError(8) : new $ff961ade9f9b5e86fd96f5b861$import$InvariantError("Can't find field " + info.fieldName + " on object " + JSON.stringify(info.object, null, 2) + ".");
      });
    }

    if (previousResult) {
      if ($ff961ade9f9b5e86fd96f5b861$import$isEqual(previousResult, execResult.result)) {
        execResult.result = previousResult;
      }
    }

    return {
      result: execResult.result,
      complete: !hasMissingFields
    };
  };

  StoreReader.prototype.executeStoreQuery = function (_a) {
    var query = _a.query,
        rootValue = _a.rootValue,
        contextValue = _a.contextValue,
        variableValues = _a.variableValues,
        _b = _a.fragmentMatcher,
        fragmentMatcher = _b === void 0 ? $ff961ade9f9b5e86fd96f5b861$var$defaultFragmentMatcher : _b;
    var mainDefinition = $ff961ade9f9b5e86fd96f5b861$import$getMainDefinition(query);
    var fragments = $ff961ade9f9b5e86fd96f5b861$import$getFragmentDefinitions(query);
    var fragmentMap = $ff961ade9f9b5e86fd96f5b861$import$createFragmentMap(fragments);
    var execContext = {
      query: query,
      fragmentMap: fragmentMap,
      contextValue: contextValue,
      variableValues: variableValues,
      fragmentMatcher: fragmentMatcher
    };
    return this.executeSelectionSet({
      selectionSet: mainDefinition.selectionSet,
      rootValue: rootValue,
      execContext: execContext
    });
  };

  StoreReader.prototype.executeSelectionSet = function (_a) {
    var _this = this;

    var selectionSet = _a.selectionSet,
        rootValue = _a.rootValue,
        execContext = _a.execContext;
    var fragmentMap = execContext.fragmentMap,
        contextValue = execContext.contextValue,
        variables = execContext.variableValues;
    var finalResult = {
      result: null
    };
    var objectsToMerge = [];
    var object = contextValue.store.get(rootValue.id);
    var typename = object && object.__typename || rootValue.id === 'ROOT_QUERY' && 'Query' || void 0;

    function handleMissing(result) {
      var _a;

      if (result.missing) {
        finalResult.missing = finalResult.missing || [];

        (_a = finalResult.missing).push.apply(_a, result.missing);
      }

      return result.result;
    }

    selectionSet.selections.forEach(function (selection) {
      var _a;

      if (!$ff961ade9f9b5e86fd96f5b861$import$shouldInclude(selection, variables)) {
        return;
      }

      if ($ff961ade9f9b5e86fd96f5b861$import$isField(selection)) {
        var fieldResult = handleMissing(_this.executeField(object, typename, selection, execContext));

        if (typeof fieldResult !== 'undefined') {
          objectsToMerge.push((_a = {}, _a[$ff961ade9f9b5e86fd96f5b861$import$resultKeyNameFromField(selection)] = fieldResult, _a));
        }
      } else {
        var fragment = void 0;

        if ($ff961ade9f9b5e86fd96f5b861$import$isInlineFragment(selection)) {
          fragment = selection;
        } else {
          fragment = fragmentMap[selection.name.value];

          if (!fragment) {
            throw "production" === "production" ? new $ff961ade9f9b5e86fd96f5b861$import$InvariantError(9) : new $ff961ade9f9b5e86fd96f5b861$import$InvariantError("No fragment named " + selection.name.value);
          }
        }

        var typeCondition = fragment.typeCondition && fragment.typeCondition.name.value;
        var match = !typeCondition || execContext.fragmentMatcher(rootValue, typeCondition, contextValue);

        if (match) {
          var fragmentExecResult = _this.executeSelectionSet({
            selectionSet: fragment.selectionSet,
            rootValue: rootValue,
            execContext: execContext
          });

          if (match === 'heuristic' && fragmentExecResult.missing) {
            fragmentExecResult = $ff961ade9f9b5e86fd96f5b861$import$__assign($ff961ade9f9b5e86fd96f5b861$import$__assign({}, fragmentExecResult), {
              missing: fragmentExecResult.missing.map(function (info) {
                return $ff961ade9f9b5e86fd96f5b861$import$__assign($ff961ade9f9b5e86fd96f5b861$import$__assign({}, info), {
                  tolerable: true
                });
              })
            });
          }

          objectsToMerge.push(handleMissing(fragmentExecResult));
        }
      }
    });
    finalResult.result = $ff961ade9f9b5e86fd96f5b861$import$mergeDeepArray(objectsToMerge);

    if (this.freezeResults && "production" !== 'production') {
      Object.freeze(finalResult.result);
    }

    return finalResult;
  };

  StoreReader.prototype.executeField = function (object, typename, field, execContext) {
    var variables = execContext.variableValues,
        contextValue = execContext.contextValue;
    var fieldName = field.name.value;
    var args = $ff961ade9f9b5e86fd96f5b861$import$argumentsObjectFromField(field, variables);
    var info = {
      resultKey: $ff961ade9f9b5e86fd96f5b861$import$resultKeyNameFromField(field),
      directives: $ff961ade9f9b5e86fd96f5b861$import$getDirectiveInfoFromField(field, variables)
    };
    var readStoreResult = $ff961ade9f9b5e86fd96f5b861$var$readStoreResolver(object, typename, fieldName, args, contextValue, info);

    if (Array.isArray(readStoreResult.result)) {
      return this.combineExecResults(readStoreResult, this.executeSubSelectedArray({
        field: field,
        array: readStoreResult.result,
        execContext: execContext
      }));
    }

    if (!field.selectionSet) {
      $ff961ade9f9b5e86fd96f5b861$var$assertSelectionSetForIdValue(field, readStoreResult.result);

      if (this.freezeResults && "production" !== 'production') {
        $ff961ade9f9b5e86fd96f5b861$import$maybeDeepFreeze(readStoreResult);
      }

      return readStoreResult;
    }

    if (readStoreResult.result == null) {
      return readStoreResult;
    }

    return this.combineExecResults(readStoreResult, this.executeSelectionSet({
      selectionSet: field.selectionSet,
      rootValue: readStoreResult.result,
      execContext: execContext
    }));
  };

  StoreReader.prototype.combineExecResults = function () {
    var execResults = [];

    for (var _i = 0; _i < arguments.length; _i++) {
      execResults[_i] = arguments[_i];
    }

    var missing;
    execResults.forEach(function (execResult) {
      if (execResult.missing) {
        missing = missing || [];
        missing.push.apply(missing, execResult.missing);
      }
    });
    return {
      result: execResults.pop().result,
      missing: missing
    };
  };

  StoreReader.prototype.executeSubSelectedArray = function (_a) {
    var _this = this;

    var field = _a.field,
        array = _a.array,
        execContext = _a.execContext;
    var missing;

    function handleMissing(childResult) {
      if (childResult.missing) {
        missing = missing || [];
        missing.push.apply(missing, childResult.missing);
      }

      return childResult.result;
    }

    array = array.map(function (item) {
      if (item === null) {
        return null;
      }

      if (Array.isArray(item)) {
        return handleMissing(_this.executeSubSelectedArray({
          field: field,
          array: item,
          execContext: execContext
        }));
      }

      if (field.selectionSet) {
        return handleMissing(_this.executeSelectionSet({
          selectionSet: field.selectionSet,
          rootValue: item,
          execContext: execContext
        }));
      }

      $ff961ade9f9b5e86fd96f5b861$var$assertSelectionSetForIdValue(field, item);
      return item;
    });

    if (this.freezeResults && "production" !== 'production') {
      Object.freeze(array);
    }

    return {
      result: array,
      missing: missing
    };
  };

  return StoreReader;
}();

function $ff961ade9f9b5e86fd96f5b861$var$assertSelectionSetForIdValue(field, value) {
  if (!field.selectionSet && $ff961ade9f9b5e86fd96f5b861$import$isIdValue(value)) {
    throw "production" === "production" ? new $ff961ade9f9b5e86fd96f5b861$import$InvariantError(10) : new $ff961ade9f9b5e86fd96f5b861$import$InvariantError("Missing selection set for object of type " + value.typename + " returned for query field " + field.name.value);
  }
}

function $ff961ade9f9b5e86fd96f5b861$var$defaultFragmentMatcher() {
  return true;
}

function $ff961ade9f9b5e86fd96f5b861$export$assertIdValue(idValue) {
  "production" === "production" ? $ff961ade9f9b5e86fd96f5b861$import$invariant($ff961ade9f9b5e86fd96f5b861$import$isIdValue(idValue), 11) : $ff961ade9f9b5e86fd96f5b861$import$invariant($ff961ade9f9b5e86fd96f5b861$import$isIdValue(idValue), "Encountered a sub-selection on the query, but the store doesn't have an object reference. This should never happen during normal use unless you have custom code that is directly manipulating the store; please file an issue.");
}

function $ff961ade9f9b5e86fd96f5b861$var$readStoreResolver(object, typename, fieldName, args, context, _a) {
  var resultKey = _a.resultKey,
      directives = _a.directives;
  var storeKeyName = fieldName;

  if (args || directives) {
    storeKeyName = $ff961ade9f9b5e86fd96f5b861$import$getStoreKeyName(storeKeyName, args, directives);
  }

  var fieldValue = void 0;

  if (object) {
    fieldValue = object[storeKeyName];

    if (typeof fieldValue === 'undefined' && context.cacheRedirects && typeof typename === 'string') {
      var type = context.cacheRedirects[typename];

      if (type) {
        var resolver = type[fieldName];

        if (resolver) {
          fieldValue = resolver(object, args, {
            getCacheKey: function (storeObj) {
              var id = context.dataIdFromObject(storeObj);
              return id && $ff961ade9f9b5e86fd96f5b861$import$toIdValue({
                id: id,
                typename: storeObj.__typename
              });
            }
          });
        }
      }
    }
  }

  if (typeof fieldValue === 'undefined') {
    return {
      result: fieldValue,
      missing: [{
        object: object,
        fieldName: storeKeyName,
        tolerable: false
      }]
    };
  }

  if ($ff961ade9f9b5e86fd96f5b861$import$isJsonValue(fieldValue)) {
    fieldValue = fieldValue.json;
  }

  return {
    result: fieldValue
  };
}

var $ff961ade9f9b5e86fd96f5b861$export$ObjectCache = function () {
  function ObjectCache(data) {
    if (data === void 0) {
      data = Object.create(null);
    }

    this.data = data;
  }

  ObjectCache.prototype.toObject = function () {
    return this.data;
  };

  ObjectCache.prototype.get = function (dataId) {
    return this.data[dataId];
  };

  ObjectCache.prototype.set = function (dataId, value) {
    this.data[dataId] = value;
  };

  ObjectCache.prototype.delete = function (dataId) {
    this.data[dataId] = void 0;
  };

  ObjectCache.prototype.clear = function () {
    this.data = Object.create(null);
  };

  ObjectCache.prototype.replace = function (newData) {
    this.data = newData || Object.create(null);
  };

  return ObjectCache;
}();

function $ff961ade9f9b5e86fd96f5b861$export$defaultNormalizedCacheFactory(seed) {
  return new $ff961ade9f9b5e86fd96f5b861$export$ObjectCache(seed);
}

var $ff961ade9f9b5e86fd96f5b861$export$WriteError = function (_super) {
  $ff961ade9f9b5e86fd96f5b861$import$__extends(WriteError, _super);

  function WriteError() {
    var _this = _super !== null && _super.apply(this, arguments) || this;

    _this.type = 'WriteError';
    return _this;
  }

  return WriteError;
}(Error);

function $ff961ade9f9b5e86fd96f5b861$export$enhanceErrorWithDocument(error, document) {
  var enhancedError = new $ff961ade9f9b5e86fd96f5b861$export$WriteError("Error writing result to store for query:\n " + JSON.stringify(document));
  enhancedError.message += '\n' + error.message;
  enhancedError.stack = error.stack;
  return enhancedError;
}

var $ff961ade9f9b5e86fd96f5b861$export$StoreWriter = function () {
  function StoreWriter() {}

  StoreWriter.prototype.writeQueryToStore = function (_a) {
    var query = _a.query,
        result = _a.result,
        _b = _a.store,
        store = _b === void 0 ? $ff961ade9f9b5e86fd96f5b861$var$defaultNormalizedCacheFactory() : _b,
        variables = _a.variables,
        dataIdFromObject = _a.dataIdFromObject,
        fragmentMatcherFunction = _a.fragmentMatcherFunction;
    return this.writeResultToStore({
      dataId: 'ROOT_QUERY',
      result: result,
      document: query,
      store: store,
      variables: variables,
      dataIdFromObject: dataIdFromObject,
      fragmentMatcherFunction: fragmentMatcherFunction
    });
  };

  StoreWriter.prototype.writeResultToStore = function (_a) {
    var dataId = _a.dataId,
        result = _a.result,
        document = _a.document,
        _b = _a.store,
        store = _b === void 0 ? $ff961ade9f9b5e86fd96f5b861$var$defaultNormalizedCacheFactory() : _b,
        variables = _a.variables,
        dataIdFromObject = _a.dataIdFromObject,
        fragmentMatcherFunction = _a.fragmentMatcherFunction;
    var operationDefinition = $ff961ade9f9b5e86fd96f5b861$import$getOperationDefinition(document);

    try {
      return this.writeSelectionSetToStore({
        result: result,
        dataId: dataId,
        selectionSet: operationDefinition.selectionSet,
        context: {
          store: store,
          processedData: {},
          variables: $ff961ade9f9b5e86fd96f5b861$import$assign({}, $ff961ade9f9b5e86fd96f5b861$import$getDefaultValues(operationDefinition), variables),
          dataIdFromObject: dataIdFromObject,
          fragmentMap: $ff961ade9f9b5e86fd96f5b861$import$createFragmentMap($ff961ade9f9b5e86fd96f5b861$import$getFragmentDefinitions(document)),
          fragmentMatcherFunction: fragmentMatcherFunction
        }
      });
    } catch (e) {
      throw $ff961ade9f9b5e86fd96f5b861$export$enhanceErrorWithDocument(e, document);
    }
  };

  StoreWriter.prototype.writeSelectionSetToStore = function (_a) {
    var _this = this;

    var result = _a.result,
        dataId = _a.dataId,
        selectionSet = _a.selectionSet,
        context = _a.context;
    var variables = context.variables,
        store = context.store,
        fragmentMap = context.fragmentMap;
    selectionSet.selections.forEach(function (selection) {
      var _a;

      if (!$ff961ade9f9b5e86fd96f5b861$import$shouldInclude(selection, variables)) {
        return;
      }

      if ($ff961ade9f9b5e86fd96f5b861$import$isField(selection)) {
        var resultFieldKey = $ff961ade9f9b5e86fd96f5b861$import$resultKeyNameFromField(selection);
        var value = result[resultFieldKey];

        if (typeof value !== 'undefined') {
          _this.writeFieldToStore({
            dataId: dataId,
            value: value,
            field: selection,
            context: context
          });
        } else {
          var isDefered = false;
          var isClient = false;

          if (selection.directives && selection.directives.length) {
            isDefered = selection.directives.some(function (directive) {
              return directive.name && directive.name.value === 'defer';
            });
            isClient = selection.directives.some(function (directive) {
              return directive.name && directive.name.value === 'client';
            });
          }

          if (!isDefered && !isClient && context.fragmentMatcherFunction) {
            "production" === "production" || $ff961ade9f9b5e86fd96f5b861$import$invariant.warn("Missing field " + resultFieldKey + " in " + JSON.stringify(result, null, 2).substring(0, 100));
          }
        }
      } else {
        var fragment = void 0;

        if ($ff961ade9f9b5e86fd96f5b861$import$isInlineFragment(selection)) {
          fragment = selection;
        } else {
          fragment = (fragmentMap || {})[selection.name.value];
          "production" === "production" ? $ff961ade9f9b5e86fd96f5b861$import$invariant(fragment, 4) : $ff961ade9f9b5e86fd96f5b861$import$invariant(fragment, "No fragment named " + selection.name.value + ".");
        }

        var matches = true;

        if (context.fragmentMatcherFunction && fragment.typeCondition) {
          var id = dataId || 'self';
          var idValue = $ff961ade9f9b5e86fd96f5b861$import$toIdValue({
            id: id,
            typename: undefined
          });
          var fakeContext = {
            store: new $ff961ade9f9b5e86fd96f5b861$export$ObjectCache((_a = {}, _a[id] = result, _a)),
            cacheRedirects: {}
          };
          var match = context.fragmentMatcherFunction(idValue, fragment.typeCondition.name.value, fakeContext);

          if (!$ff961ade9f9b5e86fd96f5b861$import$isProduction() && match === 'heuristic') {
            "production" === "production" || $ff961ade9f9b5e86fd96f5b861$import$invariant.error('WARNING: heuristic fragment matching going on!');
          }

          matches = !!match;
        }

        if (matches) {
          _this.writeSelectionSetToStore({
            result: result,
            selectionSet: fragment.selectionSet,
            dataId: dataId,
            context: context
          });
        }
      }
    });
    return store;
  };

  StoreWriter.prototype.writeFieldToStore = function (_a) {
    var _b;

    var field = _a.field,
        value = _a.value,
        dataId = _a.dataId,
        context = _a.context;
    var variables = context.variables,
        dataIdFromObject = context.dataIdFromObject,
        store = context.store;
    var storeValue;
    var storeObject;
    var storeFieldName = $ff961ade9f9b5e86fd96f5b861$import$storeKeyNameFromField(field, variables);

    if (!field.selectionSet || value === null) {
      storeValue = value != null && typeof value === 'object' ? {
        type: 'json',
        json: value
      } : value;
    } else if (Array.isArray(value)) {
      var generatedId = dataId + "." + storeFieldName;
      storeValue = this.processArrayValue(value, generatedId, field.selectionSet, context);
    } else {
      var valueDataId = dataId + "." + storeFieldName;
      var generated = true;

      if (!$ff961ade9f9b5e86fd96f5b861$var$isGeneratedId(valueDataId)) {
        valueDataId = '$' + valueDataId;
      }

      if (dataIdFromObject) {
        var semanticId = dataIdFromObject(value);
        "production" === "production" ? $ff961ade9f9b5e86fd96f5b861$import$invariant(!semanticId || !$ff961ade9f9b5e86fd96f5b861$var$isGeneratedId(semanticId), 5) : $ff961ade9f9b5e86fd96f5b861$import$invariant(!semanticId || !$ff961ade9f9b5e86fd96f5b861$var$isGeneratedId(semanticId), 'IDs returned by dataIdFromObject cannot begin with the "$" character.');

        if (semanticId || typeof semanticId === 'number' && semanticId === 0) {
          valueDataId = semanticId;
          generated = false;
        }
      }

      if (!$ff961ade9f9b5e86fd96f5b861$var$isDataProcessed(valueDataId, field, context.processedData)) {
        this.writeSelectionSetToStore({
          dataId: valueDataId,
          result: value,
          selectionSet: field.selectionSet,
          context: context
        });
      }

      var typename = value.__typename;
      storeValue = $ff961ade9f9b5e86fd96f5b861$import$toIdValue({
        id: valueDataId,
        typename: typename
      }, generated);
      storeObject = store.get(dataId);
      var escapedId = storeObject && storeObject[storeFieldName];

      if (escapedId !== storeValue && $ff961ade9f9b5e86fd96f5b861$import$isIdValue(escapedId)) {
        var hadTypename = escapedId.typename !== undefined;
        var hasTypename = typename !== undefined;
        var typenameChanged = hadTypename && hasTypename && escapedId.typename !== typename;
        "production" === "production" ? $ff961ade9f9b5e86fd96f5b861$import$invariant(!generated || escapedId.generated || typenameChanged, 6) : $ff961ade9f9b5e86fd96f5b861$import$invariant(!generated || escapedId.generated || typenameChanged, "Store error: the application attempted to write an object with no provided id but the store already contains an id of " + escapedId.id + " for this object. The selectionSet that was trying to be written is:\n" + JSON.stringify(field));
        "production" === "production" ? $ff961ade9f9b5e86fd96f5b861$import$invariant(!hadTypename || hasTypename, 7) : $ff961ade9f9b5e86fd96f5b861$import$invariant(!hadTypename || hasTypename, "Store error: the application attempted to write an object with no provided typename but the store already contains an object with typename of " + escapedId.typename + " for the object of id " + escapedId.id + ". The selectionSet that was trying to be written is:\n" + JSON.stringify(field));

        if (escapedId.generated) {
          if (typenameChanged) {
            if (!generated) {
              store.delete(escapedId.id);
            }
          } else {
            $ff961ade9f9b5e86fd96f5b861$var$mergeWithGenerated(escapedId.id, storeValue.id, store);
          }
        }
      }
    }

    storeObject = store.get(dataId);

    if (!storeObject || !$ff961ade9f9b5e86fd96f5b861$import$isEqual(storeValue, storeObject[storeFieldName])) {
      store.set(dataId, $ff961ade9f9b5e86fd96f5b861$import$__assign($ff961ade9f9b5e86fd96f5b861$import$__assign({}, storeObject), (_b = {}, _b[storeFieldName] = storeValue, _b)));
    }
  };

  StoreWriter.prototype.processArrayValue = function (value, generatedId, selectionSet, context) {
    var _this = this;

    return value.map(function (item, index) {
      if (item === null) {
        return null;
      }

      var itemDataId = generatedId + "." + index;

      if (Array.isArray(item)) {
        return _this.processArrayValue(item, itemDataId, selectionSet, context);
      }

      var generated = true;

      if (context.dataIdFromObject) {
        var semanticId = context.dataIdFromObject(item);

        if (semanticId) {
          itemDataId = semanticId;
          generated = false;
        }
      }

      if (!$ff961ade9f9b5e86fd96f5b861$var$isDataProcessed(itemDataId, selectionSet, context.processedData)) {
        _this.writeSelectionSetToStore({
          dataId: itemDataId,
          result: item,
          selectionSet: selectionSet,
          context: context
        });
      }

      return $ff961ade9f9b5e86fd96f5b861$import$toIdValue({
        id: itemDataId,
        typename: item.__typename
      }, generated);
    });
  };

  return StoreWriter;
}();

function $ff961ade9f9b5e86fd96f5b861$var$isGeneratedId(id) {
  return id[0] === '$';
}

function $ff961ade9f9b5e86fd96f5b861$var$mergeWithGenerated(generatedKey, realKey, cache) {
  if (generatedKey === realKey) {
    return false;
  }

  var generated = cache.get(generatedKey);
  var real = cache.get(realKey);
  var madeChanges = false;
  Object.keys(generated).forEach(function (key) {
    var value = generated[key];
    var realValue = real[key];

    if ($ff961ade9f9b5e86fd96f5b861$import$isIdValue(value) && $ff961ade9f9b5e86fd96f5b861$var$isGeneratedId(value.id) && $ff961ade9f9b5e86fd96f5b861$import$isIdValue(realValue) && !$ff961ade9f9b5e86fd96f5b861$import$isEqual(value, realValue) && $ff961ade9f9b5e86fd96f5b861$var$mergeWithGenerated(value.id, realValue.id, cache)) {
      madeChanges = true;
    }
  });
  cache.delete(generatedKey);
  var newRealValue = $ff961ade9f9b5e86fd96f5b861$import$__assign($ff961ade9f9b5e86fd96f5b861$import$__assign({}, generated), real);

  if ($ff961ade9f9b5e86fd96f5b861$import$isEqual(newRealValue, real)) {
    return madeChanges;
  }

  cache.set(realKey, newRealValue);
  return true;
}

function $ff961ade9f9b5e86fd96f5b861$var$isDataProcessed(dataId, field, processedData) {
  if (!processedData) {
    return false;
  }

  if (processedData[dataId]) {
    if (processedData[dataId].indexOf(field) >= 0) {
      return true;
    } else {
      processedData[dataId].push(field);
    }
  } else {
    processedData[dataId] = [field];
  }

  return false;
}

var $ff961ade9f9b5e86fd96f5b861$var$defaultConfig = {
  fragmentMatcher: new $ff961ade9f9b5e86fd96f5b861$export$HeuristicFragmentMatcher(),
  dataIdFromObject: $ff961ade9f9b5e86fd96f5b861$export$defaultDataIdFromObject,
  addTypename: true,
  resultCaching: true,
  freezeResults: false
};

function $ff961ade9f9b5e86fd96f5b861$export$defaultDataIdFromObject(result) {
  if (result.__typename) {
    if (result.id !== undefined) {
      return result.__typename + ":" + result.id;
    }

    if (result._id !== undefined) {
      return result.__typename + ":" + result._id;
    }
  }

  return null;
}

var $ff961ade9f9b5e86fd96f5b861$var$hasOwn$1 = Object.prototype.hasOwnProperty;

var $ff961ade9f9b5e86fd96f5b861$var$OptimisticCacheLayer = function (_super) {
  $ff961ade9f9b5e86fd96f5b861$import$__extends(OptimisticCacheLayer, _super);

  function OptimisticCacheLayer(optimisticId, parent, transaction) {
    var _this = _super.call(this, Object.create(null)) || this;

    _this.optimisticId = optimisticId;
    _this.parent = parent;
    _this.transaction = transaction;
    return _this;
  }

  OptimisticCacheLayer.prototype.toObject = function () {
    return $ff961ade9f9b5e86fd96f5b861$import$__assign($ff961ade9f9b5e86fd96f5b861$import$__assign({}, this.parent.toObject()), this.data);
  };

  OptimisticCacheLayer.prototype.get = function (dataId) {
    return $ff961ade9f9b5e86fd96f5b861$var$hasOwn$1.call(this.data, dataId) ? this.data[dataId] : this.parent.get(dataId);
  };

  return OptimisticCacheLayer;
}($ff961ade9f9b5e86fd96f5b861$export$ObjectCache);

var $ff961ade9f9b5e86fd96f5b861$export$InMemoryCache = function (_super) {
  $ff961ade9f9b5e86fd96f5b861$import$__extends(InMemoryCache, _super);

  function InMemoryCache(config) {
    if (config === void 0) {
      config = {};
    }

    var _this = _super.call(this) || this;

    _this.watches = new Set();
    _this.typenameDocumentCache = new Map();
    _this.cacheKeyRoot = new $ff961ade9f9b5e86fd96f5b861$import$KeyTrie($ff961ade9f9b5e86fd96f5b861$import$canUseWeakMap);
    _this.silenceBroadcast = false;
    _this.config = $ff961ade9f9b5e86fd96f5b861$import$__assign($ff961ade9f9b5e86fd96f5b861$import$__assign({}, $ff961ade9f9b5e86fd96f5b861$var$defaultConfig), config);

    if (_this.config.customResolvers) {
      "production" === "production" || $ff961ade9f9b5e86fd96f5b861$import$invariant.warn('customResolvers have been renamed to cacheRedirects. Please update your config as we will be deprecating customResolvers in the next major version.');
      _this.config.cacheRedirects = _this.config.customResolvers;
    }

    if (_this.config.cacheResolvers) {
      "production" === "production" || $ff961ade9f9b5e86fd96f5b861$import$invariant.warn('cacheResolvers have been renamed to cacheRedirects. Please update your config as we will be deprecating cacheResolvers in the next major version.');
      _this.config.cacheRedirects = _this.config.cacheResolvers;
    }

    _this.addTypename = !!_this.config.addTypename;
    _this.data = _this.config.resultCaching ? new $ff961ade9f9b5e86fd96f5b861$var$DepTrackingCache() : new $ff961ade9f9b5e86fd96f5b861$export$ObjectCache();
    _this.optimisticData = _this.data;
    _this.storeWriter = new $ff961ade9f9b5e86fd96f5b861$export$StoreWriter();
    _this.storeReader = new $ff961ade9f9b5e86fd96f5b861$export$StoreReader({
      cacheKeyRoot: _this.cacheKeyRoot,
      freezeResults: config.freezeResults
    });
    var cache = _this;
    var maybeBroadcastWatch = cache.maybeBroadcastWatch;
    _this.maybeBroadcastWatch = $ff961ade9f9b5e86fd96f5b861$import$wrap(function (c) {
      return maybeBroadcastWatch.call(_this, c);
    }, {
      makeCacheKey: function (c) {
        if (c.optimistic) {
          return;
        }

        if (c.previousResult) {
          return;
        }

        if (cache.data instanceof $ff961ade9f9b5e86fd96f5b861$var$DepTrackingCache) {
          return cache.cacheKeyRoot.lookup(c.query, JSON.stringify(c.variables));
        }
      }
    });
    return _this;
  }

  InMemoryCache.prototype.restore = function (data) {
    if (data) this.data.replace(data);
    return this;
  };

  InMemoryCache.prototype.extract = function (optimistic) {
    if (optimistic === void 0) {
      optimistic = false;
    }

    return (optimistic ? this.optimisticData : this.data).toObject();
  };

  InMemoryCache.prototype.read = function (options) {
    if (typeof options.rootId === 'string' && typeof this.data.get(options.rootId) === 'undefined') {
      return null;
    }

    var fragmentMatcher = this.config.fragmentMatcher;
    var fragmentMatcherFunction = fragmentMatcher && fragmentMatcher.match;
    return this.storeReader.readQueryFromStore({
      store: options.optimistic ? this.optimisticData : this.data,
      query: this.transformDocument(options.query),
      variables: options.variables,
      rootId: options.rootId,
      fragmentMatcherFunction: fragmentMatcherFunction,
      previousResult: options.previousResult,
      config: this.config
    }) || null;
  };

  InMemoryCache.prototype.write = function (write) {
    var fragmentMatcher = this.config.fragmentMatcher;
    var fragmentMatcherFunction = fragmentMatcher && fragmentMatcher.match;
    this.storeWriter.writeResultToStore({
      dataId: write.dataId,
      result: write.result,
      variables: write.variables,
      document: this.transformDocument(write.query),
      store: this.data,
      dataIdFromObject: this.config.dataIdFromObject,
      fragmentMatcherFunction: fragmentMatcherFunction
    });
    this.broadcastWatches();
  };

  InMemoryCache.prototype.diff = function (query) {
    var fragmentMatcher = this.config.fragmentMatcher;
    var fragmentMatcherFunction = fragmentMatcher && fragmentMatcher.match;
    return this.storeReader.diffQueryAgainstStore({
      store: query.optimistic ? this.optimisticData : this.data,
      query: this.transformDocument(query.query),
      variables: query.variables,
      returnPartialData: query.returnPartialData,
      previousResult: query.previousResult,
      fragmentMatcherFunction: fragmentMatcherFunction,
      config: this.config
    });
  };

  InMemoryCache.prototype.watch = function (watch) {
    var _this = this;

    this.watches.add(watch);
    return function () {
      _this.watches.delete(watch);
    };
  };

  InMemoryCache.prototype.evict = function (query) {
    throw "production" === "production" ? new $ff961ade9f9b5e86fd96f5b861$import$InvariantError(1) : new $ff961ade9f9b5e86fd96f5b861$import$InvariantError("eviction is not implemented on InMemory Cache");
  };

  InMemoryCache.prototype.reset = function () {
    this.data.clear();
    this.broadcastWatches();
    return Promise.resolve();
  };

  InMemoryCache.prototype.removeOptimistic = function (idToRemove) {
    var toReapply = [];
    var removedCount = 0;
    var layer = this.optimisticData;

    while (layer instanceof $ff961ade9f9b5e86fd96f5b861$var$OptimisticCacheLayer) {
      if (layer.optimisticId === idToRemove) {
        ++removedCount;
      } else {
        toReapply.push(layer);
      }

      layer = layer.parent;
    }

    if (removedCount > 0) {
      this.optimisticData = layer;

      while (toReapply.length > 0) {
        var layer_1 = toReapply.pop();
        this.performTransaction(layer_1.transaction, layer_1.optimisticId);
      }

      this.broadcastWatches();
    }
  };

  InMemoryCache.prototype.performTransaction = function (transaction, optimisticId) {
    var _a = this,
        data = _a.data,
        silenceBroadcast = _a.silenceBroadcast;

    this.silenceBroadcast = true;

    if (typeof optimisticId === 'string') {
      this.data = this.optimisticData = new $ff961ade9f9b5e86fd96f5b861$var$OptimisticCacheLayer(optimisticId, this.optimisticData, transaction);
    }

    try {
      transaction(this);
    } finally {
      this.silenceBroadcast = silenceBroadcast;
      this.data = data;
    }

    this.broadcastWatches();
  };

  InMemoryCache.prototype.recordOptimisticTransaction = function (transaction, id) {
    return this.performTransaction(transaction, id);
  };

  InMemoryCache.prototype.transformDocument = function (document) {
    if (this.addTypename) {
      var result = this.typenameDocumentCache.get(document);

      if (!result) {
        result = $ff961ade9f9b5e86fd96f5b861$import$addTypenameToDocument(document);
        this.typenameDocumentCache.set(document, result);
        this.typenameDocumentCache.set(result, result);
      }

      return result;
    }

    return document;
  };

  InMemoryCache.prototype.broadcastWatches = function () {
    var _this = this;

    if (!this.silenceBroadcast) {
      this.watches.forEach(function (c) {
        return _this.maybeBroadcastWatch(c);
      });
    }
  };

  InMemoryCache.prototype.maybeBroadcastWatch = function (c) {
    c.callback(this.diff({
      query: c.query,
      variables: c.variables,
      previousResult: c.previousResult && c.previousResult(),
      optimistic: c.optimistic
    }));
  };

  return InMemoryCache;
}($ff961ade9f9b5e86fd96f5b861$import$ApolloCache);

$ff961ade9f9b5e86fd96f5b861$exports.enhanceErrorWithDocument = $ff961ade9f9b5e86fd96f5b861$export$enhanceErrorWithDocument;
$ff961ade9f9b5e86fd96f5b861$exports.defaultNormalizedCacheFactory = $ff961ade9f9b5e86fd96f5b861$export$defaultNormalizedCacheFactory;
$ff961ade9f9b5e86fd96f5b861$exports.defaultDataIdFromObject = $ff961ade9f9b5e86fd96f5b861$export$defaultDataIdFromObject;
$ff961ade9f9b5e86fd96f5b861$exports.assertIdValue = $ff961ade9f9b5e86fd96f5b861$export$assertIdValue;
$ff961ade9f9b5e86fd96f5b861$exports.WriteError = $ff961ade9f9b5e86fd96f5b861$export$WriteError;
$ff961ade9f9b5e86fd96f5b861$exports.StoreWriter = $ff961ade9f9b5e86fd96f5b861$export$StoreWriter;
$ff961ade9f9b5e86fd96f5b861$exports.StoreReader = $ff961ade9f9b5e86fd96f5b861$export$StoreReader;
$ff961ade9f9b5e86fd96f5b861$exports.ObjectCache = $ff961ade9f9b5e86fd96f5b861$export$ObjectCache;
$ff961ade9f9b5e86fd96f5b861$exports.IntrospectionFragmentMatcher = $ff961ade9f9b5e86fd96f5b861$export$IntrospectionFragmentMatcher;
$ff961ade9f9b5e86fd96f5b861$exports.InMemoryCache = $ff961ade9f9b5e86fd96f5b861$export$InMemoryCache;
$ff961ade9f9b5e86fd96f5b861$exports.HeuristicFragmentMatcher = $ff961ade9f9b5e86fd96f5b861$export$HeuristicFragmentMatcher;